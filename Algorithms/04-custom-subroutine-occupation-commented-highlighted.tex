\begin{algorithm}[H]
  \begin{algorithmic}[1]
    \algrestore{namoue_augmented}

    \Procedure{OPT-EVALUATE-ACTION}{$o$, $p_{opt}$, $G$, $R$, $R_{goal}$, \hlgreen{$occCostGrid$}}

      \State $P_{o,g}$ $\gets \emptyset$
      \State $BA \gets null$

      \For{each $pushPose$ in $o.pushPoses$}
        \State $pushUnit \gets (cos(pushPose.yaw), sin(pushPose.yaw))$

        \State $c_{1} \gets A$*$(R, pushPose, $G$)$

        \State $seq \gets 1$

        \State $translation \gets pushUnit * onePushDist * seq$

        \State $oSimPosition \gets pushPose + translation$

        \State \hlgreen{$suppC_{M} \gets $GET-OCC-COST(get-occupied-map-points($o$, $oSimPosition$), $occCostGrid$)}

        \State $c_{3_{(Est)}} \gets \{oSimPosition, R_{goal}\}$

        \State $C_{est} \gets |c_{1}| + seq * o.C_{M} * $\hlgreen{$suppC_{M}$}$ + |c_{3_{(Est)}}|$

        \State $safeSweptArea \gets $get-safe-swept-area($o$, $translation$, $G$)

        \While{$safeSweptArea \neq$ null AND $C_{est}$ $ \leq p_{opt}.cost$}

          \If{CHECK-NEW-OPENING($G$, $o$, $next\_manipulation\_step$, $BA$)}
            \State $c_{2} \gets \{pushPose, oSimPosition\}$
            \State $c_{3} \gets A$*($oSimPosition$, $R_{goal}$, $G$)
            \State $p.path \gets c_{1} + c_{2} + c_{3}$
            \State $p.cost \gets (|c_{1}| + |c_{3}|) * moveCost + |c_{2}| * o.C_{M} * $\hlgreen{$suppC_{M}$}
            \State $p.minCost \gets |c_{2}| * o.C_{M} * $\hlgreen{$suppC_{M}$}$ + |c_{3}| * moveCost$
            \State $p.o \gets o$
            \State $p.m \gets m$
            \State $p.safeSweptArea \gets safeSweptArea$
            \State $P_{o,m} \gets P_{o,m} \bigcup \{p\}$
          \EndIf

          \State $seq \gets seq + 1$

          \State $translation \gets pushUnit * onePushDist * seq$

          \State $oSimPosition \gets pushPose + translation$

          \State \hlgreen{$suppC_{M} \gets $GET-OCC-COST(get-occupied-map-points($o$, $oSimPosition$), $occCostGrid$)}

          \State $c_{3_{(Est)}} \gets \{oSimPosition, R_{goal}\}$

          \State $C_{est} \gets |c_{1}| + seq * o.C_{M} * $\hlgreen{$suppC_{M}$}$ + |c_{3_{(Est)}}|$

          \State $safeSweptArea \gets $get-safe-swept-area($o$, $translation$, $G$)

        \EndWhile

      \EndFor

    \State return $p \in P_{o,m}$ with minimal $p.cost$

    \EndProcedure

    \Procedure{get-occ-cost}{$simOccPoints$, $occCostGrid$}

      \State{$cost \gets 0$}

      \For{each $point$ in $simOccPoints$}
        \State $valueForPoint \gets occCostGrid[point]$
        \If{$valueForPoint = FORBIDDEN\_VALUE$}
          \State return $INF$
        \EndIf
        \State{$cost \gets cost + valueForPoint / MAX\_VALUE$}
      \EndFor

      \State return $cost$
    \EndProcedure

  \end{algorithmic}
\end{algorithm}
